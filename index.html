<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOON KING PILLS - OFFICIAL SITE</title>
    <style>
        body {
            background: black url('https://web.archive.org/web/20091019162556/http://www.geocities.com/montvillefire/flames3.gif') repeat;
            color: #ffffff;
            font-family: Impact, "Comic Sans MS", Papyrus;
            text-align: center;
            cursor: url('https://cur.cursors-4u.net/others/oth-1/oth4.cur'), auto;
        }

        h1, h2, h3, h4, h5, h6, p, li, a, strong {
            -webkit-text-stroke: 1px black;
            text-shadow:
                -1px -1px 0 black,
                1px -1px 0 black,
                -1px 1px 0 black,
                1px 1px 0 black,
                -1px 0 0 black,
                1px 0 0 black,
                0 1px 0 black,
                0 -1px 0 black;
        }

        marquee {
            font-size: 50px;
            color: red;
            font-weight: bold;
            background: black;
            border: 5px solid firebrick;
            text-transform: uppercase;
        }

        #volume-slider-container {
            position: absolute;
            top: 90px;
            right: 10px;
            z-index: 10;
        }

        #volume-slider {
            width: 200px;
        }

        .blink {
            animation: blinker 0.5s infinite alternate;
        }

        @keyframes blinker {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .pill {
            font-size: 70px;
            color: orangered;
            text-shadow: 10px 10px black;
            transform: rotate(-10deg);
        }

        .sidebar {
            background-color: rgba(220, 20, 60, 0.8);
            color: white;
            padding: 20px;
            width: 300px;
            position: absolute;
            left: 10px;
            top: 180px;
            border: 10px groove firebrick;
            text-align: left;
        }

        .sidebar a {
            color: white;
        }

        .counter {
            font-size: 50px;
            background: black;
            color: red;
            padding: 20px;
            border: 10px dotted firebrick;
            display: inline-block;
            text-transform: uppercase;
        }

        .guestbook {
            font-size: 25px;
            background: darkred;
            color: white;
            padding: 30px;
            margin: 40px;
            border: 10px dashed orangered;
            transform: skew(-15deg);
        }

        .skull {
            width: 400px;
        }

        .image-container {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            position: relative;
            top: -1100px;
        }

        .image-container img {
            width: 230px;
            height: 320px;
            margin-top: 20px;
        }

        .coming-soon {
            color: red;
            font-size: 24px;
            margin-top: 0px;
        }

        #phosphor-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #back-btn {
            background: red;
            color: white;
            padding: 10px;
            border: none;
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 20px;
            cursor: pointer;
        }

        #back-btn:hover {
            background: darkred;
        }

        iframe {
            border: none;
            border-radius: 10px;
            box-shadow: none;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .iframe-container {
            position: relative;
            width: 640px;
            height: 480px;
            overflow: hidden;
        }

        .fire-effect {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, red, yellow);
            border-radius: 50%;
            opacity: 1;
            animation: fire 0.2s ease-out forwards;
        }

        @keyframes fire {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        #flappy-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #flappy-back-btn {
            background: red;
            color: white;
            padding: 10px;
            border: none;
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 20px;
            cursor: pointer;
        }

        #flappy-board {
            background-color: #87CEEB;
            border: 4px solid #00008B;
            border-radius: 8px;
        }

    </style>
</head>
<body>
    <marquee behavior="alternate" scrollamount="10">ðŸ”¥ðŸ”¥ WELCOME TO GOONKINGPILLS.COM ðŸ”¥ðŸ”¥</marquee>
    <h1 class="pill">ðŸ’Š GOON KING PILLS ðŸ’Š</h1>
    <video id="video" width="320" height="240" poster="static-image.jpg" onclick="toggleVideo()" loop>
        <source src="https://github.com/GavinE00000/Goonking/raw/main/Website%20intro.mp4" type="video/mp4">
    </video>
    <p><strong>BUY NOW OR YOU WILL BE FLACCID FOREVER</strong></p>
    <p>ðŸš¨ <span class="blink">WARNING: MAXIMUM TESTOSTERONE OVERLOAD ðŸš¨</span></p>
    <div class="sidebar">
        <h3>ðŸ”¥ MENU ðŸ”¥</h3>
        <ul>
            <li><a href="#" id="cookbook-link">ðŸ’¥NEW!ðŸ’¥ The Goonfather's Cookbook</a></li>
            <li><a href="#" id="flappy-link">ðŸ’¥NEW!ðŸ’¥ Flappy Goon</a></li>
            <li><a href="#">Buy Pills</a></li>
            <li><a href="#">Testimonials</a></li>
            <li><a href="#">Side Effects</a></li>
            <li><a href="#">EXTREME GOONING ZONE</a></li>
        </ul>
    </div>
    <h2>WHAT OUR USERS SAY:</h2>
    <p>"I TOOK ONE GOON KING PILL AND GREW A BEARD INSTANTLY" - Brock Meathead</p>
    <p>"THESE PILLS PUNCHED ME IN THE FACE. I THANKED THEM." - Tommy Tuffguy</p>
    <p>"AFTER TAKING THIS, I BENCH PRESSED A CAR." - Johnny Powerlifter</p>
    <h2>ðŸ”¥ WARNING: "SIDE EFFECTS" INCLUDE ðŸ”¥</h2>
    <ul>
        <li>Instant Muscle Growth</li>
        <li>Excessive Chest Hair</li>
        <li>Uncontrollable ALPHA MALE Energy</li>
        <li>Random EPIC Explosions</li>
        <li>Permanent Goon Mode Activation</li>
    </ul>
    <h2>VISITOR COUNTER:</h2>
    <div class="counter">
        <script>
            document.write(Math.floor(Math.random() * 100000) + 1);
        </script>
    </div>
    
    <h2>ðŸ”¥ SIGN OUR GUESTBOOK ðŸ”¥</h2>
    <div class="guestbook">
        <form>
            Name: <input type="text" name="name"><br>
            Message: <textarea></textarea><br>
            <input type="submit" value="SIGN GUESTBOOK">
        </form>
    </div>

    <p><strong>NOT FDA APPROVED. MAY CAUSE UNSTOPPABLE GOONING.</strong></p>
    <img src="https://web.archive.org/web/20030326075726/http://in.geocities.com:80/healthrevolution/mall/virilitypills4.gif" alt="Under Construction">
    <div id="volume-slider-container">
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
</div>
<div id="funky-button-container" style="position: absolute; right: 35px; top: 76px; width: 150px; margin-top: 10px;">
    <button id="play-music-btn" style="font-size: 120px; border: none; background: none; cursor: pointer; transform: rotate(-35deg);">ðŸ’Š</button>
    <a href="#" onclick="playRandomMusic();" style="position: absolute; top: 67px; left: 59%; transform: translateX(-50%) rotate(10deg); white-space: nowrap; color: white; font-weight: bold; font-size: 30px; text-shadow: -1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black; text-decoration: none;">GET FUNKY</a>
</div>
</div>

<audio id="bg-music"></audio>
    
    <audio id="gun-sound">
    <source src="https://media.memesoundeffects.com/2022/11/Pew-Sound-Sound-Effect.mp3" type="audio/mpeg">
</audio>
<div class="image-container">
    <img src="https://raw.githubusercontent.com/GavinE00000/Goonking/main/Goon%20pill.png" alt="Image 1">
    <div>
        <h3 class="coming-soon">â†“â†“â†“ COMING SOON! â†“â†“â†“</h3>
        <img src="https://raw.githubusercontent.com/GavinE00000/Goonking/main/263fd2c6-dd19-492c-a80e-669aabad6a84-large3x4_Dumpster.png" alt="Image 2">
    </div>
</div>
<div id="phosphor-container">
    <button id="back-btn">Back</button>
    <div class="iframe-container">
        <iframe id="scratch-iframe" src="https://scratch.mit.edu/projects/1148127326/embed/?autostart=true" width="640" height="480" allow="autoplay; fullscreen"></iframe>
    </div>
</div>
<div id="flappy-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.9); z-index: 1001; justify-content: center; align-items: center; text-align: center;">
    <button id="flappy-back-btn" style="background: red; color: white; padding: 10px; border: none; position: absolute; top: 20px; left: 20px; font-size: 20px; cursor: pointer;">Back</button>
    <canvas id="flappy-board"></canvas>
</div>
<script>
const flappyLink = document.getElementById('flappy-link');
const flappyOverlay = document.getElementById('flappy-overlay');
const flappyBackBtn = document.getElementById('flappy-back-btn');
const body = document.body;
let flappyGameInstance = null;
let flappyScriptLoaded = false;

flappyLink.addEventListener('click', function(e) {
    e.preventDefault();
    flappyOverlay.style.display = 'flex';
    bgMusic.pause();
    body.style.overflow = 'hidden';

    // Dynamically load the flappybird.js script
    if (!flappyScriptLoaded) {
        const script = document.createElement('script');
        script.src = 'flappybird.js';
        document.body.appendChild(script);

        script.onload = function() {
            flappyScriptLoaded = true;
            // Get the canvas element here
            const canvas = document.getElementById('flappy-board');
            // Call startFlappyGame and pass the canvas
            flappyGameInstance = startFlappyGame(canvas);
        };

        script.onerror = function() {
            // error handling
        };
    } else {
        const canvas = document.getElementById('flappy-board');
        flappyGameInstance = startFlappyGame(canvas);
    }
});

flappyBackBtn.addEventListener('click', function() {
    flappyOverlay.style.display = 'none';
    bgMusic.play();
    body.style.overflow = 'auto';
    if (flappyGameInstance) {
      //  cancelAnimationFrame(flappyGameInstance); // Stop the animation loop
        flappyGameInstance = null; // Reset the instance
    }
});


</script>

<script>
    const bgMusic = document.getElementById('bg-music');
    const musicTracks = [
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/I%20Will%20survive.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Lets%20Dance.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Eye-Of-The-Tiger-(From-Rocky).mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Warren%20G%20-%20Regulate.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/BONEY%20M.Rasputin%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Thriller.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Bon%20Jovi%20-%20Living%20on%20a%20Prayer.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Bad-To-The-Bone.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/system_of_a_down-chop_suey(1).mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/A%20HA.Take%20on%20me%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/AFROMAN.Because%20i%20got%20high%20k.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Everybody-Wants-To-Rule-The-World-2.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/SHAGGY.I%20wasnt%20me%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/STEELY%20DAN.Peg%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Softcell%20-%20Tainted%20Love%20L.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/THE%20LIPPS.Funkytown%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/system_of_a_down-chop_suey(1).mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Brandy-(Youre-Are-A-Fine-Girl).mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Break-My-Stride.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Dancing-In-The-Moonlight.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/FALCO.Rock%20me%20amadeus.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Get-Outta-My-Dreams-Get-Into-My-Car-1.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/MARLEY.Jamming%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Paula%20Abdul%20-%20Straight%20Up%20L.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Surfin-USA-3.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/The%20Vapors%20-%20Turning%20Japanese.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/ALLMAN%20BR.Ramblin%20man.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Bob%20Seger%20-%20Hollywood%20Nights.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/C.DOUGLAS.Kung%20fu%20fighting%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Doobie%20Brothers%20-%20What%20A%20Fool%20Believes.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Peter%20Gabriel%20-%20Sledgehammer%20L.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/THE%20ROMANTICS.Talking%20in%20your%20sleep%20k.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Talking%20Heads%20-%20Once%20in%20a%20Lifetime.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Red-Red-Wine-3.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/THE%20PLATTERS.Under%20the%20boardwalk%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/TOTO.Africa%20K.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/The%20Police%20-%20Message%20in%20a%20Bottle.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Billy%20Joel%20-%20You%20May%20Be%20Right.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Gary-Numan.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/Prince%20-%20Raspberry%20Beret.mp3",
            "https://raw.githubusercontent.com/GavinE00000/Goonking/main/VAN%20HALEN.Right%20now.mp3"
    ];
    let isPlaying = false;
    const newAudio = new Audio('https://raw.githubusercontent.com/GavinE00000/Goonking/main/The%20Goonfather%20Trailer.mp3');

    // Define playRandomMusic() ONCE, OUTSIDE the event listener
    function playRandomMusic() {
        const randomIndex = Math.floor(Math.random() * musicTracks.length);
        bgMusic.src = musicTracks[randomIndex];
        bgMusic.load();
        bgMusic.play();
    }

    document.getElementById('play-music-btn').addEventListener('click', function() {
        playRandomMusic();
    });

    bgMusic.addEventListener('ended', function() {
        playRandomMusic(); // Call playRandomMusic() again to get a new random track
    });

    // Simulate "autoplay" when link is clicked
    document.getElementById('cookbook-link').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('phosphor-container').style.display = 'flex';
        bgMusic.pause();
        document.body.style.overflow = 'hidden';
        iframe.src = "https://scratch.mit.edu/projects/1148127326/embed/?autostart=true";
    });

    // Hide overlay and resume music when "Back" is clicked
    document.getElementById('back-btn').addEventListener('click', function() {
        document.getElementById('phosphor-container').style.display = 'none';
        bgMusic.play();
        document.body.style.overflow = 'auto';
    });

    // Add the gun sound and fire effect functionality
    const gunSound = document.getElementById('gun-sound');
    const body = document.body;

    body.addEventListener('click', function(event) {
        gunSound.play();

        const fireEffect = document.createElement('div');
        fireEffect.classList.add('fire-effect');
        fireEffect.style.left = `${event.pageX - 25}px`;
        fireEffect.style.top = `${event.pageY - 25}px`;

        body.appendChild(fireEffect);

        setTimeout(() => {
            fireEffect.remove();
        }, 200);
    });

    // Toggle MP3 play/pause when image is clicked
    const image = document.querySelector('.image-container img:nth-child(2)');
    if (image) {
        image.addEventListener('click', function() {
            if (isPlaying) {
                newAudio.pause();
                newAudio.currentTime = 0;
                bgMusic.play(); // Resume background music
            } else {
                newAudio.play();
                bgMusic.pause(); // Pause background music
            }
            isPlaying = !isPlaying; //Toggle state
        });
    }
var video = document.getElementById("video");
    var backgroundMusic = document.getElementById("bg-music");

    function toggleVideo() {
        if (video.paused) {
            video.play();
            bgMusic.pause(); // Pause background music when video plays
        } else {
            video.pause();
            bgMusic.play(); // Resume background music when video pauses
        }
    }
    // --- START OF ARROW KEY MUSIC CHANGE CODE ---
    document.addEventListener('keydown', function(event) {
        if (event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
            let currentIndex = musicTracks.indexOf(bgMusic.src); // Gets the current track index
            if (event.key === 'ArrowLeft') {
                currentIndex = (currentIndex - 1 + musicTracks.length) % musicTracks.length; // Goes to the previous track
            } else {
                currentIndex = (currentIndex + 1) % musicTracks.length; // Goes to the next track
            }
            bgMusic.src = musicTracks[currentIndex]; // Sets the audio source to the next/previous track
            bgMusic.load(); // Loads the new audio source
            bgMusic.play(); // Plays the new audio source
        }
    });
    // --- END OF ARROW KEY MUSIC CHANGE CODE ---
// ... (Your existing JavaScript code) ...

        // --- VOLUME SLIDER FUNCTIONALITY ---
        const volumeSlider = document.getElementById('volume-slider');

        volumeSlider.addEventListener('input', function() {
            bgMusic.volume = volumeSlider.value;
        });

</script>
<script>
// Base resolution
const baseWidth = 360;
const baseHeight = 640;
const targetAspectRatio = baseWidth / baseHeight;

// Board
let board;
let context;

// Bird
let birdWidth;
let birdHeight;
let birdX;
let birdY;
let birdImg;

let bird;

// Pipes
let pipeArray = [];
let pipeWidth;
let pipeHeight;
let pipeX;
let pipeY = 0;

let topPipeImg;
let bottomPipeImg;

// Physics
let pipeSpeed = -2;
let velocityX;
let velocityY = 0;
let gravity;

let jumpStrength = -6;
let scaledJumpStrength;

let gameOver = false;
let score = 0;

// Sound effects (MOVED TO TOP)
let hitSound;
let dieSound;
let pointSound;
let jumpSound;
let startSound;



function initializeGame(canvasElement) {
    // Get screen dimensions
    let screenWidth = window.innerWidth;
    let screenHeight = window.innerHeight;

    // Adjust board dimensions to maintain aspect ratio
    if (screenWidth / screenHeight > targetAspectRatio) {
        boardHeight = screenHeight;
        boardWidth = boardHeight * targetAspectRatio;
    } else {
        boardWidth = screenWidth;
        boardHeight = boardWidth / targetAspectRatio;
    }

    // Calculate a single scaling factor
    const scale = boardWidth / baseWidth;

    board = canvasElement;
    board.height = boardHeight;
    board.width = boardWidth;
    context = board.getContext("2d");

    // Bird
    birdWidth = 40 * scale;
    birdHeight = 57 * scale;
    birdX = boardWidth / 8;
    birdY = boardHeight / 2;

    bird = {
        x: birdX,
        y: birdY,
        width: birdWidth,
        height: birdHeight
    };

    // Pipes
    pipeWidth = 80 * scale;
    pipeHeight = 512 * scale;
    pipeX = boardWidth;
    velocityX = pipeSpeed * scale;
    gravity = 0.4 * scale;
    scaledJumpStrength = jumpStrength * scale;


    // Load images
    birdImg = new Image();
    birdImg.src = "./flappybird.png";
    birdImg.onload = () => {
        context.drawImage(birdImg, bird.x, bird.y, bird.width, bird.height);
    };

    topPipeImg = new Image();
    topPipeImg.src = "./toppipe.png";

    bottomPipeImg = new Image();
    bottomPipeImg.src = "./bottompipe.png";

    // Load sound effects
    hitSound = new Audio("./hit.mp3");
    dieSound = new Audio("./die.mp3");
    pointSound = new Audio("./point.mp3");
    jumpSound = new Audio("./jump.mp3");
    startSound = new Audio("./start.mp3");

    // Play start sound when game loads
    startSound.play();
    pipeArray = [];
    gameOver = false;
    score = 0;

}


function startFlappyGame(canvas) {
    if (!canvas) {
        console.error("Canvas element is null or undefined.");
        return null;
    }
    initializeGame(canvas);
    let animationFrameId;

    function update() {
        if (!context) {
            console.error("Context is null.  Stopping update.");
            return;
        }
        animationFrameId = requestAnimationFrame(update);
        if (gameOver) {
            return;
        }
        context.clearRect(0, 0, boardWidth, boardHeight);

        // Bird
        velocityY += gravity;
        bird.y = Math.max(bird.y + velocityY, 0);
        context.drawImage(birdImg, bird.x, bird.y, bird.width, bird.height);

        if (bird.y > board.height) {
            gameOver = true;
            dieSound.play(); // Play die sound once
        }

        // Pipes
        for (let i = 0; i < pipeArray.length; i++) {
            let pipe = pipeArray[i];
            pipe.x += velocityX;
            context.drawImage(pipe.img, pipe.x, pipe.y, pipe.width, pipe.height);

            if (!pipe.passed && bird.x > pipe.x + pipe.width) {
                score += 0.5;
                pipe.passed = true;
                pointSound.play(); // Play point sound once
            }

            if (detectCollision(bird, pipe)) {
                if (!gameOver) {
                    hitSound.play(); // Play hit sound once
                }
                gameOver = true;
            }
        }

        // Clear pipes
        while (pipeArray.length > 0 && pipeArray[0].x < -pipeWidth) {
            pipeArray.shift();
        }

        // Score
        context.fillStyle = "white";
        context.font = "45px sans-serif";
        context.fillText(score, 5, 45);

        if (gameOver) {
            context.fillText("GAME OVER", 5, 90);
        }
        if (gameOver) {
          cancelAnimationFrame(animationFrameId);
          return; // Stop updating when the game is over.
        }
    }

    let pipeIntervalId = setInterval(placePipes, 1500);
    document.addEventListener("keydown", moveBird);
    window.addEventListener('resize', () => {
        initializeGame(canvas);
    });

    update(); // Start the game loop.

    function placePipes() {
        if (gameOver) {
            return;
        }

        let randomPipeY = pipeY - pipeHeight / 4 - Math.random() * (pipeHeight / 2);
        let openingSpace = board.height / 3.5; // Adjusted to make openings wider

        let topPipe = {
            img: topPipeImg,
            x: pipeX,
            y: randomPipeY,
            width: pipeWidth,
            height: pipeHeight,
            passed: false
        }
        pipeArray.push(topPipe);

        let bottomPipe = {
            img: bottomPipeImg,
            x: pipeX,
            y: randomPipeY + pipeHeight + openingSpace,
            width: pipeWidth,
            height: pipeHeight,
            passed: false
        }
        pipeArray.push(bottomPipe);
    }

    function moveBird(e) {
        if (e.code == "Space" || e.code == "ArrowUp" || e.code == "KeyX") {
            velocityY = scaledJumpStrength;
            jumpSound.play();

            if (gameOver) {
                initializeGame(canvas); // Reset the game state
                update();             // Start the update loop
            }
        }
    }

    function detectCollision(a, b) {
        return a.x < b.x + b.width &&
            a.x + a.width > b.x &&
            a.y < b.y + b.height &&
            a.y + a.height > b.y;
    }
    return {
        cancel: function() {
            cancelAnimationFrame(animationFrameId);
            clearInterval(pipeIntervalId);
            document.removeEventListener("keydown", moveBird);
            window.removeEventListener('resize', () => {
                initializeGame(canvas);
            });
            pipeArray = [];
            gameOver = true;
        }
    };
}
</script>
</body>
</html>
